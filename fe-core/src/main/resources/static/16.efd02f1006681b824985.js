(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1069:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var a=n(0),r=n.n(a),o=n(131),i=n.n(o),l=(n(133),n(197)),c=n.n(l),u=(n(194),n(154)),s=n.n(u),d=(n(153),n(160)),f=n.n(d),m=(n(159),n(276)),p=n.n(m),h=(n(360),n(117)),b=n(169),v=n(1),y=n(13),g=n(1062),w=n(1075),_=n(1061),E=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},O=f.a.Text,x=f.a.Title;function S(e){var t=Object(a.useRef)(null),n=Object(g.a)().t,o=E(Object(a.useState)({column_names:[],rows:[]}),2),l=o[0],u=o[1],d=E(Object(a.useState)(),2),m=d[0],S=d[1],j=Object(v.g)();function T(){var e=location.pathname.split("/").pop();return"QueryProfile"===e?"":e}function k(e,t){var n=Object(y.e)(e),a=new Blob([n],{type:"text/plain"}),r=document.createElement("a");r.download="profile_"+t+".txt",r.style.display="none",r.href=URL.createObjectURL(a),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r)}return Object(a.useEffect)((function(){var e=new AbortController;return function(e){var a={path:T(),signal:null==e?void 0:e.signal};Object(h.l)(a).then((function(e){e&&"success"===e.msg?e.data.column_names?(S(""),e.data.column_names.push("Action"),e.data.rows=e.data.rows.map((function(e){return e["Sql Statement"]=r.a.createElement("div",{style:{maxWidth:700}},r.a.createElement(w.a,{language:"sql",style:_.a},e["Sql Statement"])),e.Action=r.a.createElement(i.a,{size:"small",onClick:function(){Object(h.l)({path:e["Profile ID"]}).then((function(t){t&&"success"===t.msg&&(t.data.column_names||k(t.data,e["Profile ID"]))}))}},n("Download")),e})),u(e.data)):(S(e.data),null!==t.current&&(t.current.innerHTML=e.data)):u({column_names:[],rows:[]})})).catch((function(e){}))}(e),function(){return e.abort()}}),[location.pathname]),r.a.createElement(f.a,{style:{padding:"30px"}},r.a.createElement(x,null,"Finished Queries"),r.a.createElement(s.a,{style:{paddingBottom:"15px"}},r.a.createElement(c.a,{span:12},r.a.createElement(O,{strong:!0},"This table lists the latest 100 queries")),r.a.createElement(c.a,{span:12,style:{textAlign:"right"}},m?r.a.createElement(p.a,null,r.a.createElement(i.a,{type:"primary",onClick:function(){"/QueryProfile/"!==location.pathname&&j.push("/QueryProfile/")}},"Back"),r.a.createElement(i.a,{onClick:function(){var e=T();k(m,e)}},"Download"),r.a.createElement(i.a,{onClick:function(){!function(e){var t=Object(y.e)(e),n=document.createElement("textarea");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)}(m)}},"Copy Profile")):"")),m?r.a.createElement("div",{ref:t,style:{background:"#f9f9f9",padding:"20px"}}):r.a.createElement(b.a,{rowKey:function(e){return e["Profile ID"]},isSort:!0,isFilter:!0,isInner:"/QueryProfile",allTableData:l}))}},117:function(e,t,n){"use strict";n.d(t,"k",(function(){return w})),n.d(t,"j",(function(){return _})),n.d(t,"e",(function(){return E})),n.d(t,"h",(function(){return O})),n.d(t,"f",(function(){return x})),n.d(t,"l",(function(){return S})),n.d(t,"g",(function(){return j})),n.d(t,"d",(function(){return T})),n.d(t,"c",(function(){return k})),n.d(t,"i",(function(){return P})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return D}));var a=n(118),r=n(0),o=n.n(r),i=n(123),l=n.n(i),c=(n(124),n(137)),u=n.n(c),s=(n(136),n(1080)),d=n(1060),f=n(13),m=n(1075),p=n(1061),h=function(){return(h=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},b=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function l(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((a=a.apply(e,t||[])).next())}))},v=function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};function y(e,t,n,a,r){return void 0===t&&(t={}),void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===r&&(r=!1),b(this,void 0,void 0,(function(){var i,c,b,y,g,w,_;return v(this,(function(v){switch(v.label){case 0:return localStorage.getItem("username")||!1!==e.includes("login")?(i=Object(f.b)(),"POST"!==(c=h({credentials:"include"},t)).method&&"PUT"!==c.method||(c.headers=c.isUpload?h({},c.headers):h({"Content-Type":"application/json; charset=utf-8"},c.headers)),"object"!=typeof c.body||c.isUpload||(c.body=JSON.stringify(c.body)),i&&"/"!==i&&(e=i+e),[4,fetch(e,c)]):(function(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie=e[t]+"=0;expires="+new Date(0).toUTCString()}(),u.a.confirm({title:o.a.createElement(d.a,null,"tips"),icon:o.a.createElement(s.a,null),content:o.a.createElement(d.a,null,"loginExpirtMsg"),onOk:function(){window.location.href=window.location.origin+Object(f.b)()+"/login"},onCancel:function(){}}),[2]);case 1:return!(b=v.sent()).url.includes("dataIntegrationApi")||"PUT"!==c.method&&"POST"!==c.method&&"DELETE"!==c.method?(function(e){if(e.status>=200&&e.status<300)return e;if(401!==e.status){var t=new Error(e.statusText);throw t.response=e,l.a.error(e.statusText),t}u.a.confirm({title:o.a.createElement(d.a,null,"tips"),icon:o.a.createElement(s.a,null),content:o.a.createElement(d.a,null,"loginExpirtMsg"),onOk:function(){window.location.href=window.location.origin+Object(f.b)()+"/login"},onCancel:function(){}})}(b),t&&t.download?[2,b.blob()]:[4,b.json()]):[2,b];case 2:return("code"in(y=v.sent())||"msg"in y)&&(g=y.code,w=y.msg,401===g&&"Cookie is invalid"===y.data?u.a.confirm({title:o.a.createElement(d.a,null,"tips"),icon:o.a.createElement(s.a,null),content:o.a.createElement(d.a,null,"loginExpirtMsg"),onOk:function(){window.location.href=window.location.origin+Object(f.b)()+"/login"},onCancel:function(){}}):401===g&&"Cookie is invalid"!==y.data?l.a.error({message:o.a.createElement(d.a,null,"loginWarning")}):"success"===w||0===g||200===g?n&&l.a.success({message:o.a.createElement(d.a,null,"successfulOperation"),description:w}):a&&0!==g&&""!==w&&(_=o.a.createElement(m.a,{language:"sql",style:h(h({},p.a),{width:"300px"})},y.data),l.a.error({message:w,description:_}))),r?[2,{data:y,response:b}]:[2,y]}}))}))}var g=function(){return(g=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function w(e){return y("/rest/v1/login",{method:"POST",headers:{Authorization:e.password?"Basic "+btoa(e.username+":"+e.password):"Basic "+btoa(e.username+":")}})}function _(){return y("/rest/v1/logout",{method:"POST"})}function E(){return y("/rest/v1/hardware_info/fe/",{method:"GET"})}function O(e){return y("/rest/v1/system"+e.path,g({method:"GET"},e))}function x(e){var t="/rest/v1/log";return e.add_verbose&&(t="/rest/v1/log?add_verbose="+e.add_verbose),e.del_verbose&&(t="/rest/v1/log?del_verbose="+e.del_verbose),y(t,g({method:e.add_verbose||e.del_verbose?"POST":"GET"},e))}function S(e){var t="/rest/v1/query_profile/";return e.path&&(t="/rest/v1/query_profile/"+e.path),y(t,e)}function j(e){return y("/rest/v1/session",e)}function T(e){return y("/rest/v1/config/fe/",e)}function k(e){var t={label:e.label,columns:e.columns,column_separator:e.column_separator};return t.columns||delete t.columns,y("/api/default_cluster/"+e.db_name+"/"+e.tbl_name+"/upload?file_id="+e.file_id+"&file_uuid="+e.file_uuid,{method:"PUT",headers:t})}function P(e){var t="/api/default_cluster/"+e.db_name+"/"+e.tbl_name+"/upload";return e.preview&&(t="/api/default_cluster/"+e.db_name+"/"+e.tbl_name+"/upload?file_id="+e.file_id+"&file_uuid="+e.file_uuid+"&preview=true"),y(t,{method:"GET"})}function C(e){return y("/api/default_cluster/"+e.db_name+"/"+e.tbl_name+"/upload?file_id="+e.file_id+"&file_uuid="+e.file_uuid,{method:"DELETE"})}var D={getDatabaseList:function(e){var t=a.a+"default_cluster/databases";return e&&(e.db_name&&(t+="/"+e.db_name+"/tables"),e.db_name&&e.tbl_name&&(t+="/"+e.tbl_name+"/schema")),y(t,e)},doQuery:function(e){return y("/api/query/default_cluster/"+e.db_name,g({method:"POST"},e))},doUp:k,getLog:x,queryProfile:S,logOut:_,getHardwareInfo:E,getUploadData:P,deleteUploadData:C}},118:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var a="/api/meta/namespaces/",r=150},169:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(0),r=n.n(a),o=n(168),i=n.n(o),l=(n(167),n(201)),c=n.n(l),u=(n(195),n(152)),s=n.n(u),d=(n(144),n(1083)),f=n(18);function m(e,t,n,a,o,i,l){return a&&i&&-1!==i.indexOf(o)&&t.__hrefPaths?t.__hrefPaths[i.indexOf(o)].includes("http")?r.a.createElement("a",{href:t.__hrefPaths[i.indexOf(o)],target:"_blank"},e):"/"===location.search[location.search.length-1]?r.a.createElement(f.b,{to:l+location.search+e},e):r.a.createElement(f.b,{to:l+(location.search?location.search:a)+"/"+e},e):"\\N"===e?"-":e}n(51);var p=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};function h(e){var t=e.isFilter,n=void 0!==t&&t,o=e.isSort,l=void 0!==o&&o,u=e.allTableData,f=e.isInner,h=e.isSystem,b=void 0!==h&&h,v=e.path,y=void 0===v?"":v,g=e.rowKey,w=p(Object(a.useState)([]),2),_=w[0],E=w[1],O=p(Object(a.useState)([]),2),x=O[0],S=O[1];function j(e){var t,n,a,r=(t=u.rows,n=e.target.value,a=[],t.forEach((function(e){Object.values(e).some((function(e){return"object"!=typeof e&&(e+"").includes(n)}))&&a.push(e)})),a);E(r)}var T=r.a.createElement(s.a,{placeholder:"Filter data",onChange:function(e){return j(e)}});return Object(a.useEffect)((function(){u.rows&&u.column_names&&(S(function(e,t,n,a,r){return e&&0!==e.length?e.map((function(e,o){return t?{title:e,dataIndex:e,className:"pr-25",key:e+o,sorter:function(t,n){return function(e,t,n){return"number"==typeof e[n]&&"number"==typeof t[n]?e[n]-t[n]:e[n].localeCompare(t[n])}(t,n,e)},render:function(t,o,i){return m(t,o,0,n,e,a,r)}}:{title:e,dataIndex:e,className:"pr-25",key:e+o,render:function(t,o,i){return m(t,o,0,n,e,a,r)}}})):[]}(u.column_names,l,f,u.href_columns||u.href_column,y)),E(u.rows))}),[u]),r.a.createElement("span",{className:"systemTable"},n?r.a.createElement(c.a,{className:b?"searchSystem":"search",content:T,trigger:"click"},r.a.createElement(d.a,null)):"",r.a.createElement(i.a,{columns:x,rowKey:function(e){return"function"==typeof g?g(e):"string"==typeof g?g:void 0},dataSource:_,scroll:{x:"max-content"},size:"small",bordered:!0,pagination:{size:"small",showTotal:function(e,t){return t[0]+"-"+t[1]+" of "+e+" items"},showSizeChanger:!0,showQuickJumper:!0,defaultPageSize:30}}))}}}]);