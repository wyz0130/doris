(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1077:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return U}));var a=n(0),r=n.n(a),l=n(13),i=n(160),o=n.n(i),c=(n(159),n(1026)),u=n.n(c),s=(n(1024),n(131)),d=n.n(s),f=(n(133),n(123)),m=n.n(f),b=(n(124),n(420)),p=n.n(b),g=(n(419),n(152)),h=n.n(g),v=(n(144),n(374)),E=n.n(v),y=(n(359),n(1028)),_=n.n(y),w=(n(1025),n(168)),O=n.n(w),j=(n(167),n(265),n(1084)),k=n(117);var S=n(137),x=n.n(S);n(136);var C=n(1),T=n(1062),N=(n(100),n(298)),P=(n(101),n(34),function(){return(P=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),F=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=l.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return i},L=u.a.Step,I=E.a.Option;function U(e){var t=Object(T.a)().t,n=Object(l.b)(),i=Object(C.g)(),c=F(Object(a.useState)([]),2),s=c[0],f=c[1],b=F(Object(a.useState)(),2),g=b[0],v=b[1],y=F(Object(a.useState)([]),2),w=y[0],S=y[1],U=F(Object(a.useState)([]),2),q=U[0],D=U[1],z=F(Object(a.useState)([]),2),A=z[0],B=z[1],G=F(Object(a.useState)([]),2),W=G[0],M=G[1],J=F(Object(a.useState)(),2),R=J[0],K=J[1],H=F(Object(a.useState)(),2),Q=H[0],V=H[1],X=F(Object(a.useState)(),2),Y=X[0],Z=X[1],$=F(Object(a.useState)([]),2),ee=$[0],te=$[1],ne=F(Object(a.useState)("\t"),2),ae=ne[0],re=ne[1],le=Object(l.c)(),ie=le.db_name,oe=le.tbl_name,ce=F(p.a.useForm(),1)[0],ue=[{title:t("table")},{title:t("selectTheFile")},{title:t("loadConfig")}],se=F(Object(a.useState)(0),2),de=se[0],fe=se[1],me={labelCol:{span:3},wrapperCol:{span:6},labelAlign:"left"},be={name:"file",action:n+"/api/default_cluster/"+ie+"/"+oe+"/upload",data:{column_separator:ae,preview:"true"},fileList:ee,beforeUpload:function(e){return!(e.size/1024/1024>100)||(m.a.error({message:t("fileSizeWarning")}),!1)},onChange:function(e){"done"===e.file.status?(m.a.success({message:e.file.name+" file uploaded successfully"}),ge()):"error"===e.file.status&&(m.a.error({message:e.file.name+" file upload failed."}),D([]),B([])),2===e.fileList.length?(e.fileList=e.fileList.slice(-1),te(e.fileList)):1===e.fileList.length&&te(e.fileList),e.file.status||te([])},progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,format:function(e){return parseFloat(e.toFixed(2))+"%"}}};function pe(){ce.validateFields().then((function(e){var t={db_name:ie,tbl_name:oe,file_id:R.id,file_uuid:R.uuid,label:Q,columns:Y,column_separator:R.columnSeparator};Object(k.c)(t).then((function(e){e&&"success"===e.msg&&e.data&&(m.a.success({message:""+e.msg}),function(e,t){var n=[];for(var a in e)n.push(r.a.createElement("tr",{className:"ant-table-row",key:a},r.a.createElement("td",{className:"ant-table-cell",width:"200",key:a},a),r.a.createElement("td",{className:"ant-table-cell",key:e[a],width:"200"},e[a]&&e[a].includes("http")?r.a.createElement("a",{href:e[a],target:"_blank"},e[a]):e[a])));x.a.info({title:"Import Result",width:800,content:r.a.createElement("div",{className:"ant-table ant-table-small ant-table-bordered",style:{marginTop:15,marginLeft:"-38px"}},r.a.createElement("div",{className:"ant-table-container"},r.a.createElement("div",{className:"ant-table-content"},r.a.createElement("table",{style:{width:"100%"}},r.a.createElement("tbody",{className:"ant-table-tbody"},n))))),onOk:function(){t()}})}(e.data,(function(){i.push("/Playground/structure/"+ie+"-"+oe)})))}))})).catch((function(e){m.a.error({message:""+e})}))}function ge(){Object(k.i)({db_name:ie,tbl_name:oe}).then((function(e){if(e.data&&"success"===e.msg){var t=e.data;D(Object(N.a)(t[0],he,!0)),B(t)}})).catch((function(){D([]),B([])}))}function he(e,t,n){n.stopPropagation(),Object(k.b)({db_name:ie,tbl_name:oe,file_uuid:e.uuid,file_id:e.id}).then((function(e){ge(),M([]),M([]),K(""),v("")}))}return Object(a.useEffect)((function(){var e;e={db_name:ie,tbl_name:oe},k.a.getDatabaseList(e).then((function(e){var t,n=Object(l.c)(),a=(n.db_name,n.tbl_name);if(e&&"success"===e.msg){var r=null===(t=e.data[a])||void 0===t?void 0:t.schema;S(r),f(Object(N.a)(r[0],!1,!1))}else S([]),f([])})).catch((function(){m.a.error({message:t("errMsg")})})),ge()}),[]),r.a.createElement("div",{style:{padding:"50px"}},r.a.createElement(u.a,{current:de},ue.map((function(e){return r.a.createElement(L,{key:e.title,title:e.title})}))),r.a.createElement("div",{className:"steps-content",style:{padding:"30px"}},0===de?r.a.createElement(r.a.Fragment,null,r.a.createElement(o.a,{style:{marginTop:"20px"}},r.a.createElement("p",null,t("database"),": ",ie),r.a.createElement("p",null,t("table"),": ",oe)),r.a.createElement(o.a,{style:{paddingBottom:"15px"}},t("tableStructure"),": "),r.a.createElement(O.a,{bordered:!0,rowKey:"Field",columns:s,dataSource:w,size:"small"})):"",1===de?r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,P({},me),r.a.createElement(p.a.Item,{label:t("delimiter"),rules:[{required:!0,message:t("delimiterWarning")}]},r.a.createElement(E.a,{value:ae,onChange:function(e){re(e)},allowClear:!0},r.a.createElement(I,{value:","},","),r.a.createElement(I,{value:"|"},"|"),r.a.createElement(I,{value:"\t"},"\\t"))),r.a.createElement(p.a.Item,{label:t("selectTheFile")},r.a.createElement(_.a,P({},be),r.a.createElement(d.a,null,r.a.createElement(j.a,null),t("upload")))),r.a.createElement("p",null,t("uploadedFiles")),r.a.createElement(O.a,{bordered:!0,rowKey:"uuid",columns:q,dataSource:A,size:"small",pagination:!1,scroll:{y:240},rowClassName:function(e){return e.id===g?"clickRowStyle":""},onRow:function(e){return{onClick:function(t){var n;v((n=e).id),Object(k.i)({db_name:ie,tbl_name:oe,file_id:n.id,file_uuid:n.uuid,preview:!0}).then((function(e){if(e.data&&"success"===e.msg){var t=e.data;K(t),M((n=t.maxColNum,a=t.lines,n&&a?a.map((function(e,t){return e.length=n,e.key=t,e})):[]))}else K(""),M([]);var n,a})).catch((function(e){K(""),M([])}))}}}}),r.a.createElement("p",{style:{marginTop:"20px"}},t("filePreview"),"(",t("display10"),")"),r.a.createElement("div",{className:"ant-table ant-table-small ant-table-bordered",style:{marginTop:10}},r.a.createElement("div",{className:"ant-table-container"},r.a.createElement("div",{className:"ant-table-content"},r.a.createElement("table",{style:{width:"100%"}},r.a.createElement("tbody",{className:"ant-table-tbody"},null==W?void 0:W.map((function(e,t){return r.a.createElement("tr",{className:"ant-table-row",key:t},e.map((function(e,t){return r.a.createElement("td",{className:"ant-table-cell",key:t+e},"\\N"==e?"-":e)})))}))))))))):"",2===de?r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,P({form:ce},me),r.a.createElement(p.a.Item,{label:"Label",name:"Label",rules:[{required:!0,message:"Please Enter"}]},r.a.createElement(h.a,{value:Q,onChange:function(e){return V(e.target.value)}})),r.a.createElement(p.a.Item,{label:"columns",name:"columns",rules:[{required:!1,message:"Please Enter"}]},r.a.createElement(h.a,{value:Y,onChange:function(e){Z(e.target.value)}})))):""),r.a.createElement("div",{className:"steps-action",style:{textAlign:"end"}},de>0&&r.a.createElement(d.a,{style:{margin:"0 8px"},onClick:function(){fe(de-1)}},t("previousStep")),de<ue.length-1&&r.a.createElement(d.a,{type:"primary",onClick:function(){1!==de||R?fe(de+1):m.a.error({message:t("uploadWarning")})}},t("nextStep")),de===ue.length-1&&r.a.createElement(d.a,{type:"primary",onClick:function(){return pe()}},t("loadButton")),"Â ",r.a.createElement(d.a,{onClick:function(){i.push("/Playground/structure/"+ie+"-"+oe)}},t("cancelButton"))))}},117:function(e,t,n){"use strict";n.d(t,"k",(function(){return y})),n.d(t,"j",(function(){return _})),n.d(t,"e",(function(){return w})),n.d(t,"h",(function(){return O})),n.d(t,"f",(function(){return j})),n.d(t,"l",(function(){return k})),n.d(t,"g",(function(){return S})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return C})),n.d(t,"i",(function(){return T})),n.d(t,"b",(function(){return N})),n.d(t,"a",(function(){return P}));var a=n(118),r=n(0),l=n.n(r),i=n(123),o=n.n(i),c=(n(124),n(137)),u=n.n(c),s=(n(136),n(1080)),d=n(1060),f=n(13),m=n(1075),b=n(1061),p=function(){return(p=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},g=function(e,t,n,a){return new(n||(n=Promise))((function(r,l){function i(e){try{c(a.next(e))}catch(e){l(e)}}function o(e){try{c(a.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((a=a.apply(e,t||[])).next())}))},h=function(e,t){var n,a,r,l,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function o(l){return function(o){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&l[0]?a.return:l[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,l[1])).done)return r;switch(a=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,a=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],a=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,o])}}};function v(e,t,n,a,r){return void 0===t&&(t={}),void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===r&&(r=!1),g(this,void 0,void 0,(function(){var i,c,g,v,E,y,_;return h(this,(function(h){switch(h.label){case 0:return localStorage.getItem("username")||!1!==e.includes("login")?(i=Object(f.b)(),"POST"!==(c=p({credentials:"include"},t)).method&&"PUT"!==c.method||(c.headers=c.isUpload?p({},c.headers):p({"Content-Type":"application/json; charset=utf-8"},c.headers)),"object"!=typeof c.body||c.isUpload||(c.body=JSON.stringify(c.body)),i&&"/"!==i&&(e=i+e),[4,fetch(e,c)]):(function(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie=e[t]+"=0;expires="+new Date(0).toUTCString()}(),u.a.confirm({title:l.a.createElement(d.a,null,"tips"),icon:l.a.createElement(s.a,null),content:l.a.createElement(d.a,null,"loginExpirtMsg"),onOk:function(){window.location.href=window.location.origin+Object(f.b)()+"/login"},onCancel:function(){}}),[2]);case 1:return!(g=h.sent()).url.includes("dataIntegrationApi")||"PUT"!==c.method&&"POST"!==c.method&&"DELETE"!==c.method?(function(e){if(e.status>=200&&e.status<300)return e;if(401!==e.status){var t=new Error(e.statusText);throw t.response=e,o.a.error(e.statusText),t}u.a.confirm({title:l.a.createElement(d.a,null,"tips"),icon:l.a.createElement(s.a,null),content:l.a.createElement(d.a,null,"loginExpirtMsg"),onOk:function(){window.location.href=window.location.origin+Object(f.b)()+"/login"},onCancel:function(){}})}(g),t&&t.download?[2,g.blob()]:[4,g.json()]):[2,g];case 2:return("code"in(v=h.sent())||"msg"in v)&&(E=v.code,y=v.msg,401===E&&"Cookie is invalid"===v.data?u.a.confirm({title:l.a.createElement(d.a,null,"tips"),icon:l.a.createElement(s.a,null),content:l.a.createElement(d.a,null,"loginExpirtMsg"),onOk:function(){window.location.href=window.location.origin+Object(f.b)()+"/login"},onCancel:function(){}}):401===E&&"Cookie is invalid"!==v.data?o.a.error({message:l.a.createElement(d.a,null,"loginWarning")}):"success"===y||0===E||200===E?n&&o.a.success({message:l.a.createElement(d.a,null,"successfulOperation"),description:y}):a&&0!==E&&""!==y&&(_=l.a.createElement(m.a,{language:"sql",style:p(p({},b.a),{width:"300px"})},v.data),o.a.error({message:y,description:_}))),r?[2,{data:v,response:g}]:[2,v]}}))}))}var E=function(){return(E=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function y(e){return v("/rest/v1/login",{method:"POST",headers:{Authorization:e.password?"Basic "+btoa(e.username+":"+e.password):"Basic "+btoa(e.username+":")}})}function _(){return v("/rest/v1/logout",{method:"POST"})}function w(){return v("/rest/v1/hardware_info/fe/",{method:"GET"})}function O(e){return v("/rest/v1/system"+e.path,E({method:"GET"},e))}function j(e){var t="/rest/v1/log";return e.add_verbose&&(t="/rest/v1/log?add_verbose="+e.add_verbose),e.del_verbose&&(t="/rest/v1/log?del_verbose="+e.del_verbose),v(t,E({method:e.add_verbose||e.del_verbose?"POST":"GET"},e))}function k(e){var t="/rest/v1/query_profile/";return e.path&&(t="/rest/v1/query_profile/"+e.path),v(t,e)}function S(e){return v("/rest/v1/session",e)}function x(e){return v("/rest/v1/config/fe/",e)}function C(e){var t={label:e.label,columns:e.columns,column_separator:e.column_separator};return t.columns||delete t.columns,v("/api/default_cluster/"+e.db_name+"/"+e.tbl_name+"/upload?file_id="+e.file_id+"&file_uuid="+e.file_uuid,{method:"PUT",headers:t})}function T(e){var t="/api/default_cluster/"+e.db_name+"/"+e.tbl_name+"/upload";return e.preview&&(t="/api/default_cluster/"+e.db_name+"/"+e.tbl_name+"/upload?file_id="+e.file_id+"&file_uuid="+e.file_uuid+"&preview=true"),v(t,{method:"GET"})}function N(e){return v("/api/default_cluster/"+e.db_name+"/"+e.tbl_name+"/upload?file_id="+e.file_id+"&file_uuid="+e.file_uuid,{method:"DELETE"})}var P={getDatabaseList:function(e){var t=a.a+"default_cluster/databases";return e&&(e.db_name&&(t+="/"+e.db_name+"/tables"),e.db_name&&e.tbl_name&&(t+="/"+e.tbl_name+"/schema")),v(t,e)},doQuery:function(e){return v("/api/query/default_cluster/"+e.db_name,E({method:"POST"},e))},doUp:C,getLog:j,queryProfile:k,logOut:_,getHardwareInfo:w,getUploadData:T,deleteUploadData:N}},118:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var a="/api/meta/namespaces/",r=150},298:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(0),r=n.n(a);function l(e,t,n){if(!e)return[];var a=[];for(var l in e)"key"!==l&&("Field"===l&&t&&!n?a.push({title:"Field",dataIndex:"Field",key:"Field",render:function(e){return r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return t.handleNameClicked(e)}},e)}}):a.push({title:l,dataIndex:l,key:l,render:function(e){return r.a.createElement("span",null,"\t"===e?"\\t":e)}}));return n&&a.push({title:"Action",dataIndex:"",key:"x",render:function(e,n,a){return r.a.createElement("a",{onClick:function(e){t(n,a,e)}},"Delete")}}),a}}}]);